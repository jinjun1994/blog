---
{
title: 解构赋值,
date: 2017-12-10 20:40:33,
tags: [es6+, JavaScript]
}
---

## 一、背景知识：

对象与数组的字面量在 JS 中是最常用的两种表示法，并且感谢流行的 JSON 数据格式，它
们已成为这门语言中的格外重要的部分。定义对象与数组非常普遍，定义之后就能有条不紊
地从这些结构中提取出相关信息。为了简化提取信息的任务， ES6 新增了解构（
destructuring ），这是将一个数据结构分解为更小的部分的过程。本文介绍如何在对象与数
组上利用解构。

## 二、知识剖析

### 解构为何有用？

在 ES5 及更早版本中，从对象或数组中获取信息、并将特定数据存入本地变量，需要书写许
多并且相似的代码。例如：

```js
let options = {       
repeat: true,       
save: false   
};
// 从对象中提取数据
let repeat = options.repea    
save = options.save;
```

此代码提取了 options 对象的 repeat 与 save 值，并将其存在同名的本地变量上。虽然
这段代码看起来简单，但想象一下若有大量变量需要处理，你就必须逐个为其赋值；并且若
有一个嵌套的数据结构需要遍历以寻找信息，你可能会为了一点数据而挖掘整个结构。
这就是 ES6 为何要给对象与数组添加解构。当把数据结构分解为更小的部分时，从中提取你
要的数据会变得容易许多。很多语言都能用精简的语法来实现解构，让它更易使用。 ES6 的
解构实际使用的语法其实你早已熟悉，那就是对象与数组的字面量语法。

<!--more--> 

### 对象解构

对象解构语法在赋值语句的左侧使用了对象字面量，例如：

```js
let node = {
type: "Identifier",
name: "foo"
};
let { type, name } = node;
console.log(type); // "Identifier"
console.log(name); // "foo"
```

在此代码中， node.type 的值被存储到 type 本地变量中， node.name 的值则存储到
name 变量中。此语法相同于第四章介绍的简写的属性初始化器。 type 与 name 标识符既
声明了本地变量，也读取了对象的相应属性值。

#### 解构赋值

以上对象解构示例都用于变量声明。不过，也可以在赋值的时候使用解构。例如，你可能想
在变量声明之后改变它们的值，如下所示：

```js
let node = {
type: "Identifier",
name: "foo"
},
type = "Literal",
name = 5;
// 使用解构来分配不同的值
({ type, name } = node);
console.log(type); // "Identifier"
console.log(name); // "foo"
```

在本例中， type 与 name 属性在声明时被初始化，而两个同名变量也被声明并初始化为不
同的值。接下来一行使用了解构表达式，通过读取 node 对象来更改这两个变量的值。注意
你必须用圆括号包裹解构赋值语句，这是因为暴露的花括号会被解析为代码块语句，而块语
句不允许在赋值操作符（即等号）左侧出现。圆括号标示了里面的花括号并不是块语句、而
应该被解释为表达式，从而允许完成赋值操作。
解构赋值表达式的值为表达式右侧（在 = 之后）的值。也就是说在任何期望有个值的位置都
可以使用解构赋值表达式。

#### 默认值

当你使用解构赋值语句时，如果所指定的本地变量在对象中没有找到同名属性，那么该变量
会被赋值为 undefined 。

#### 赋值给不同的本地变量名

```js
let node = {
type: "Identifier",
name: "foo"
};
let { type: localType, name: localName } = node;
console.log(localType); // "Identifier"
console.log(localName); // "foo"
```

#### 嵌套的对象解构

```js
let node = {
    type: "Identifier",
    name: "foo",
    loc: {
        start: {
            line: 1,
            column: 1
        },
        end: {
            line: 1,
            column: 4
        }
    }
};
let { loc: { start }} = node;
console.log(start.line); // 1
console.log(start.column); // 1

```

## 三、常见问题

如何使用数组解构？ 

## 四、解决方案

### 数组解构

数组解构的语法看起来与对象解构非常相似，只是将对象字面量替换成了数组字面量。数组
解构时，解构作用在数组内部的位置上，而不是作用在对象的具名属性上，例如：

```js
let colors = [ "red", "green", "blue" ];
let [ firstColor, secondColor ] = colors;
console.log(firstColor); // "red"
console.log(secondColor); // "green"
```

此处数组解构从  colors  数组中取出了  "red"  与  "green"  ，并将它们赋值给  fristColor
与  secondColor  变量。这些值被选择，是由于它们在数组中的位置，实际的变量名称是任意
的（与位置无关）。任何没有在解构模式中明确指定的项都会被忽略。记住，数组本身并没
有以任何方式被改变。

#### 解构赋值

你可以在赋值表达式中使用数组解构，但是与对象解构不同，不必将表达式包含在圆括号
内，例如：

```js
let colors = [ "red", "green", "blue" ],
firstColor = "black",
secondColor = "purple";
[ firstColor, secondColor ] = colors;
console.log(firstColor); // "red"
console.log(secondColor); // "green"
```



#### 默认值

数组解构赋值同样允许在数组任意位置指定默认值。当指定位置的项不存在、或其值为
undefined  ，那么该默认值就会被使用

#### 嵌套的解构

与解构嵌套的对象相似，可以用类似的方式来解构嵌套的数组。在整个解构模式中插入另一
个数组模式，解构操作就会下行到嵌套的数组中，就像这样：

```js
let colors = [ "red", [ "green", "lightgreen" ], "blue" ];
// 随后
let [ firstColor, [ secondColor ] ] = colors;
console.log(firstColor); // "red"
console.log(secondColor); // "green"
```

此处的  secondColor  变量指向了  colors  数组中的  "green"  值，该项被包含在第二个数组
中，因此解构模式就要把  secondColor  包裹上方括号。与对象解构相似，你也能使用任意深
度的数组嵌套。

#### 剩余项

数组解构有个名为剩余项（ rest items ）的概
念，它使用  ...  语法来将剩余的项目赋值给一个指定的变量，此处有个范例：

```js
let colors = [ "red", "green", "blue" ];
let [ firstColor, ...restColors ] = colors;
console.log(firstColor); // "red"
console.log(restColors.length); // 2
console.log(restColors[0]); // "green"
console.log(restColors[1]); // "blue"
```



## 五、编码实战

以上

## 六、拓展思考

解构使得在 JS 中操作对象与数组变得更容易。使用熟悉的对象字面量与数组字面量语法，可
以将数据结构分离并只获取你感兴趣的信息。对象解构模式允许你从对象中进行提取，而数
组模式则能用于数组。
对象与数组解构都能在属性或项未定义时为其提供默认值；在赋值表达式右侧的值为  null
或  undefined  时，两种模式都会抛出错误。你也可以在深层嵌套的数据结构中使用对象与数
组解构，下行到该结构的任意深度。
使用  var  、  let  或  const  的解构声明来创建变量，就必须提供初始化器。解构赋值能替
代其他赋值，并且允许你把值解构到对象属性或已存在的变量上。
参数解构使用解构语法作为函数的参数，让“选项”（ options ）对象更加透明。你实际感兴趣
的数据可以与具名参数一并列出。解构的参数可以是对象模式、数组模式或混合模式，并且
你能使用它们的所有特性。



## 七、参考文献

《深入了解es6》

### 八、更多讨论

#### 1.如何**交换变量的值**：

```
[x, y] = [y, x];
```

上面代码交换变量x和y的值，这样的写法不仅简洁，而且易读，语义非常清晰。

#### 2.**从函数返回多个值**

```js
function example() {
  return [1, 2, 3];
}
var [a, b, c] = example();

// 返回一个对象

function example() {
  return {
    foo: 1,
    bar: 2
  };
}
var { foo, bar } = example();
```

#### 3.**提取 JSON 数据**

解构赋值对提取 JSON 对象中的数据，尤其有用。

```
var jsonData = {
  id: 42,
  status: "OK",
  data: [867, 5309]
}

let { id, status, data: number } = jsonData;

console.log(id, status, number)
// 42, OK, [867, 5309]
```

