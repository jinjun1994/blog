<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no, minimal-ui"
    />
    <title>前端跨域问题各种解决方案（开发环境中） | jinjun</title>
    <meta name="description" content="前端开发 JavaScript webpack 金俊 jinjun " />
    <meta property="og:type" content="website" />
    <meta property="og:title" content="前端跨域问题各种解决方案（开发环境中） | jinjun" />
    <meta property="og:site_name" content="前端跨域问题各种解决方案（开发环境中） | jinjun" />
    <meta property="og:locale" content="zh-CN" />
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:title" content="前端跨域问题各种解决方案（开发环境中） | jinjun" />
    <link rel="shortcut icon" href="/blog/favicon.ico">
    
    <link rel="preload" href="/blog/assets/css/0.styles.2df77784.css" as="style"><link rel="preload" href="/blog/assets/js/app.962901cb.js" as="script"><link rel="preload" href="/blog/assets/js/1.36b4da28.js" as="script"><link rel="preload" href="/blog/assets/js/16.1efe9ae9.js" as="script"><link rel="preload" href="/blog/assets/js/5.ab75d492.js" as="script"><link rel="preload" href="/blog/assets/js/7.5ca7d561.js" as="script"><link rel="preload" href="/blog/assets/js/14.fca58736.js" as="script"><link rel="preload" href="/blog/assets/js/6.da834821.js" as="script"><link rel="preload" href="/blog/assets/js/42.07cb1b93.js" as="script"><link rel="preload" href="/blog/assets/js/15.9cf39d09.js" as="script"><link rel="preload" href="/blog/assets/js/17.c81a99c6.js" as="script"><link rel="prefetch" href="/blog/assets/js/10.9e0e1c72.js"><link rel="prefetch" href="/blog/assets/js/11.1f959de4.js"><link rel="prefetch" href="/blog/assets/js/12.ef11b7f2.js"><link rel="prefetch" href="/blog/assets/js/13.70f4995a.js"><link rel="prefetch" href="/blog/assets/js/18.fddf6aeb.js"><link rel="prefetch" href="/blog/assets/js/19.7ed7e296.js"><link rel="prefetch" href="/blog/assets/js/20.d1d02fdd.js"><link rel="prefetch" href="/blog/assets/js/21.66f4e9c1.js"><link rel="prefetch" href="/blog/assets/js/22.7eaa53d7.js"><link rel="prefetch" href="/blog/assets/js/23.d43fd536.js"><link rel="prefetch" href="/blog/assets/js/24.b81eab33.js"><link rel="prefetch" href="/blog/assets/js/25.e0013478.js"><link rel="prefetch" href="/blog/assets/js/26.f5e70498.js"><link rel="prefetch" href="/blog/assets/js/27.b82b89ef.js"><link rel="prefetch" href="/blog/assets/js/28.5c1d53a7.js"><link rel="prefetch" href="/blog/assets/js/29.913058a4.js"><link rel="prefetch" href="/blog/assets/js/30.926e85e7.js"><link rel="prefetch" href="/blog/assets/js/31.9ffa8d6d.js"><link rel="prefetch" href="/blog/assets/js/32.566a2132.js"><link rel="prefetch" href="/blog/assets/js/33.e6a95c97.js"><link rel="prefetch" href="/blog/assets/js/34.27c09604.js"><link rel="prefetch" href="/blog/assets/js/35.9dde9283.js"><link rel="prefetch" href="/blog/assets/js/36.dce4cb52.js"><link rel="prefetch" href="/blog/assets/js/37.baa3bfae.js"><link rel="prefetch" href="/blog/assets/js/38.78c6dae0.js"><link rel="prefetch" href="/blog/assets/js/39.8e154953.js"><link rel="prefetch" href="/blog/assets/js/4.c0856dc5.js"><link rel="prefetch" href="/blog/assets/js/40.0ac0b115.js"><link rel="prefetch" href="/blog/assets/js/41.7e3ca534.js"><link rel="prefetch" href="/blog/assets/js/43.91e50540.js"><link rel="prefetch" href="/blog/assets/js/44.54d815da.js"><link rel="prefetch" href="/blog/assets/js/45.d6d0167c.js"><link rel="prefetch" href="/blog/assets/js/8.546a26e3.js"><link rel="prefetch" href="/blog/assets/js/9.7c71ad7b.js"><link rel="prefetch" href="/blog/assets/js/search.7bc66dd3.js">
    <link rel="stylesheet" href="/blog/assets/css/0.styles.2df77784.css">
  </head>
  <body>
    <div id="loader-wrapper" style="display: none;opacity:0">
      <div id="loader"></div>
      <div class="loader-section section-left"></div>
      <div class="loader-section section-right"></div>
    </div>
    <div id="app" data-server-rendered="true"><div style="height:100%;" data-v-5d0d200e><section class="el-container main-container" data-v-5d0d200e><aside class="el-aside menu" style="width:auto;" data-v-7a66351a data-v-5d0d200e><ul role="menubar" class="menu-wrap el-menu" style="background-color:;" data-v-7a66351a><li data-v-7a66351a><div class="brand-wrap" style="background-image:url();" data-v-7a66351a><div class="brand" data-v-7a66351a><a href="/blog/" class="avatar waves-effect waves-circle waves-light router-link-active" data-v-7a66351a><img src="/blog/avatar.png" data-v-7a66351a></a> <hgroup class="introduce" data-v-7a66351a><div class="nickname" data-v-7a66351a>jinjun</div> <a title="jinjun199403@gmail.com" class="mail" data-v-7a66351a>jinjun199403@gmail.com</a></hgroup></div></div></li> <li role="menuitem" tabindex="-1" class="el-menu-item" style="padding-left:20px;color:;background-color:;" data-v-7a66351a><i class="iconfont icon-home" data-v-7a66351a></i> <span class="item-title" data-v-7a66351a>主页</span></li> <li role="menuitem" tabindex="-1" class="el-menu-item" style="padding-left:20px;color:;background-color:;" data-v-7a66351a><i class="iconfont icon-biaoqian" data-v-7a66351a></i> <span class="item-title" data-v-7a66351a>标签分类</span></li> <li role="menuitem" tabindex="-1" class="el-menu-item" style="padding-left:20px;color:;background-color:;" data-v-7a66351a><i class="iconfont icon-wenzhang" data-v-7a66351a></i> <span class="item-title" data-v-7a66351a>时间归档</span></li> <li role="menuitem" tabindex="-1" class="el-menu-item" style="padding-left:20px;color:;background-color:;" data-v-7a66351a><i class="iconfont icon-github" data-v-7a66351a></i> <span class="item-title" data-v-7a66351a>Github</span></li> <li role="menuitem" tabindex="-1" class="el-menu-item" style="padding-left:20px;color:;background-color:;" data-v-7a66351a><i class="iconfont icon-aboutme" data-v-7a66351a></i> <span class="item-title" data-v-7a66351a>关于我</span></li></ul></aside> <section class="el-container container-warp" data-v-5d0d200e><header id="topHeader" class="el-header top-header" style="height:60px;padding-left:260px;" data-v-462e0cef data-v-5d0d200e><div class="header-warp el-row is-align-middle el-row--flex" data-v-462e0cef><div class="el-col el-col-12 el-col-xs-7" data-v-462e0cef><div class="el-row is-align-middle el-row--flex" data-v-462e0cef><div class="el-col el-col-2" data-v-462e0cef><button type="button" class="el-button el-button--primary is-circle" data-v-462e0cef><!----><!----><span><i class="iconfont icon-caidan" data-v-462e0cef></i></span></button></div></div></div> <div class="el-col el-col-20 el-col-xs-24" data-v-462e0cef><div class="grid-content bg-purple-light" data-v-462e0cef><div class="el-row is-justify-end is-align-middle el-row--flex" data-v-462e0cef><div class="el-col el-col-13 el-col-xs-24 el-col-sm-21 el-col-md-17 el-col-lg-13" data-v-462e0cef><div aria-haspopup="listbox" role="combobox" aria-owns="el-autocomplete-4591" class="el-autocomplete search-input" data-v-462e0cef><div class="el-input el-input--small el-input--suffix"><!----><input type="text" autocomplete="off" valueKey="value" popperClass="search-popper" placeholder="搜搜看" fetchSuggestions="function () { [native code] }" debounce="300" placement="bottom-start" popperAppendToBody="true" value="" class="el-input__inner"><!----><span class="el-input__suffix"><span class="el-input__suffix-inner"><i class="el-input__icon el-icon-search search-ico" data-v-462e0cef></i><!----><!----><!----></span><!----></span><!----></div><div role="region" class="el-autocomplete-suggestion el-popper search-popper" style="width:;display:none;"><div class="el-scrollbar"><div class="el-autocomplete-suggestion__wrap el-scrollbar__wrap el-scrollbar__wrap--hidden-default"><ul class="el-scrollbar__view el-autocomplete-suggestion__list"></ul></div><div class="el-scrollbar__bar is-horizontal"><div class="el-scrollbar__thumb" style="width:0;transform:translateX(0%);ms-transform:translateX(0%);webkit-transform:translateX(0%);"></div></div><div class="el-scrollbar__bar is-vertical"><div class="el-scrollbar__thumb" style="height:0;transform:translateY(0%);ms-transform:translateY(0%);webkit-transform:translateY(0%);"></div></div></div></div></div></div></div></div></div></div></header> <main class="el-main my-main" style="margin-left:240px;" data-v-c4863568 data-v-5d0d200e><div class="content-header index-header" data-v-82ac95c6 data-v-c4863568><div class="container fade-scale in" data-v-82ac95c6><h1 id="conentHeader" class="title" data-v-82ac95c6>前端跨域问题各种解决方案（开发环境中）</h1> <h5 class="subtitle" data-v-82ac95c6>最后更新时间：2019-03-19 12:34:26</h5></div></div> <div data-v-991417e8 data-v-c4863568 data-v-c4863568><div class="post-content el-row is-justify-center el-row--flex" data-v-991417e8><div id="post-card" class="post-card el-col el-col-16 el-col-xs-24 el-col-sm-23 el-col-md-23 el-col-lg-16" data-v-991417e8><div class="content default"><h3 id="什么是跨域"><a href="#什么是跨域" aria-hidden="true" class="header-anchor">#</a> 什么是跨域</h3> <p>域（Domain）是网络中独立运行的单位，域之间相互访问则需要建立信任关系（即Trust Relation）。信任关系是连接在域与域之间的桥梁。当一个域与其他域建立了信任关系后，2个域之间不但可以按需要相互进行管理，还可以跨网分配资源，使不同的域之间实现网络资源的共享与管理。跨域访问是指，没有建立信任关系的两个域之间通讯，但是由于安全原因，跨域访问是被各大浏览器所默认禁止的。</p> <h3 id="哪些属于跨域"><a href="#哪些属于跨域" aria-hidden="true" class="header-anchor">#</a> 哪些属于跨域</h3> <p>浏览器遵循同源次略，非同源即为跨域，非同源分为三种。</p> <ul><li>host不一致。</li> <li>端口不一致。</li> <li>协议不一致。</li></ul> <p>上面三种，任意满足一种都是跨域，在请求的时候就会报错。根据上面的原理，我们可以发现在开发中，我们在浏览器打开的我们本地页面地址和请求地址不在一个源中，所以产生了跨域。</p> <p>下表给出了相对 <a href="http://store.company.com/dir/page.html" target="_blank" rel="noopener noreferrer">http://store.company.com/dir/page.html<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> 同源检测的示例:</p> <table><thead><tr><th>URL</th> <th>结果</th> <th>原因</th></tr></thead> <tbody><tr><td><a href="http://store.company.com/dir/inner/another.html" target="_blank" rel="noopener noreferrer">http://store.company.com/dir/inner/another.html<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></td> <td>成功</td> <td>同一域名</td></tr> <tr><td><a href="http://store.company.com/dir2/other.html" target="_blank" rel="noopener noreferrer">http://store.company.com/dir2/other.html<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></td> <td>成功</td> <td>同一域名下不同文件夹</td></tr> <tr><td><a href="https://store.company.com/secure.html" target="_blank" rel="noopener noreferrer">https://store.company.com/secure.html<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></td> <td>失败</td> <td>不同的协议 ( https )</td></tr> <tr><td><a href="http://store.company.com:81/dir/etc.html" target="_blank" rel="noopener noreferrer">http://store.company.com:81/dir/etc.html<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></td> <td>失败</td> <td>不同的端口 ( 81 )</td></tr> <tr><td><a href="http://news.company.com/dir/other.html" target="_blank" rel="noopener noreferrer">http://news.company.com/dir/other.html<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></td> <td>失败</td> <td>不同的主机 ( news )</td></tr></tbody></table> <h3 id="解决跨域的方法和原理"><a href="#解决跨域的方法和原理" aria-hidden="true" class="header-anchor">#</a> 解决跨域的方法和原理</h3> <p>我们知道了跨域的原理，那么开发中，应该如何解决这个问题呢？</p> <h4 id="反向代理"><a href="#反向代理" aria-hidden="true" class="header-anchor">#</a> 反向代理</h4> <p>前面我们了解了，跨域问题的产生是因为浏览器的同源政策造成的，但是服务器与服务器之间的数据交换是没有这个限制，反向代理就是采用这种方式，建立一个虚拟的代理服务器来接收internet上的链接请求，然后转发给内部网络上的服务器，并将从服务器上得到的结果，返回给internet上请求链接的客户端。比如，我们常用的gulp、grunt、webpack这些脚手架都是通过这种原理解决的跨域。</p> <p>具体实现：</p> <p><strong>1.使用gulp脚手架解决跨域</strong></p> <p>gulp中有两个解决跨域的包有gulp-connect-proxy、http-proxy-middleware，拿http-proxy-middleware为例，需要与gulp-connect一起使用：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>    <span class="token keyword">var</span> gulp <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'gulp'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        
    <span class="token keyword">var</span> proxy <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'http-proxy-middleware'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">var</span> connect <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'gulp-connect'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        gulp<span class="token punctuation">.</span><span class="token function">task</span><span class="token punctuation">(</span><span class="token string">'server'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            connect<span class="token punctuation">.</span><span class="token function">server</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
                 root<span class="token punctuation">:</span> <span class="token string">'app'</span><span class="token punctuation">,</span>
                 livereload<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
                 host<span class="token punctuation">:</span> <span class="token string">'localhost'</span><span class="token punctuation">,</span>
                 port<span class="token punctuation">:</span> <span class="token string">&quot;8080&quot;</span><span class="token punctuation">,</span>
                 middleware<span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span>req<span class="token punctuation">,</span> res<span class="token punctuation">,</span> next<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                   <span class="token keyword">return</span> <span class="token punctuation">[</span>
                             <span class="token function">proxy</span><span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
                             target<span class="token punctuation">:</span> <span class="token string">'targeturl'</span><span class="token punctuation">,</span>
                             changeOrigin<span class="token punctuation">:</span> <span class="token boolean">true</span>
                                <span class="token punctuation">}</span><span class="token punctuation">)</span>
                            <span class="token punctuation">]</span><span class="token punctuation">;</span>
                        <span class="token punctuation">}</span>
                    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    gulp<span class="token punctuation">.</span><span class="token function">task</span><span class="token punctuation">(</span><span class="token string">'default'</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">'server'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

                <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div><p><strong>2.使用grunt脚手架解决跨域</strong></p> <p>grunt和gulp其实是类似的，都是需要先连接本地服务，然后设置代理，grunt使用的的跨域插件是grunt-connect-proxy，需要与grunt-contrib-connect一起使用：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>    connect<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    options<span class="token punctuation">:</span> <span class="token punctuation">{</span>
               port<span class="token punctuation">:</span> ‘<span class="token number">8080</span>‘<span class="token punctuation">,</span>
               hostname<span class="token punctuation">:</span> ‘localhost‘<span class="token punctuation">,</span>
               protocol<span class="token punctuation">:</span> ‘http‘<span class="token punctuation">,</span>
               open<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
               base<span class="token punctuation">:</span> <span class="token punctuation">{</span>
               path<span class="token punctuation">:</span> ‘<span class="token punctuation">.</span><span class="token operator">/</span>‘<span class="token punctuation">,</span>
                options<span class="token punctuation">:</span> <span class="token punctuation">{</span>
                index<span class="token punctuation">:</span> ‘html<span class="token operator">/</span>index<span class="token punctuation">.</span>html‘
                        <span class="token punctuation">}</span>
                    <span class="token punctuation">}</span><span class="token punctuation">,</span>
                    livereload<span class="token punctuation">:</span> <span class="token boolean">true</span>
                <span class="token punctuation">}</span><span class="token punctuation">,</span>
                proxies<span class="token punctuation">:</span> <span class="token punctuation">[</span>
                    <span class="token punctuation">{</span>
                        context<span class="token punctuation">:</span> ‘<span class="token operator">/</span>‘ <span class="token operator">+</span> <span class="token constant">API_NAME</span><span class="token punctuation">,</span>
                        host<span class="token punctuation">:</span> ‘localhost‘<span class="token punctuation">,</span>
                        port<span class="token punctuation">:</span> ‘<span class="token number">8080</span>‘<span class="token punctuation">,</span>
                        https<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
                        changeOrigin<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
                        rewrite<span class="token punctuation">:</span> proxyRewrite
                    <span class="token punctuation">}</span>
                <span class="token punctuation">]</span><span class="token punctuation">,</span>
                <span class="token keyword">default</span><span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
                proxy<span class="token punctuation">:</span> <span class="token punctuation">{</span>
                    options<span class="token punctuation">:</span> <span class="token punctuation">{</span>
                        middleware<span class="token punctuation">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>connect<span class="token punctuation">,</span> options<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>Array<span class="token punctuation">.</span><span class="token function">isArray</span><span class="token punctuation">(</span>options<span class="token punctuation">.</span>base<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                                options<span class="token punctuation">.</span>base <span class="token operator">=</span> <span class="token punctuation">[</span>options<span class="token punctuation">.</span>base<span class="token punctuation">]</span><span class="token punctuation">;</span>
                            <span class="token punctuation">}</span>
            <span class="token comment">// Setup the proxy</span>
            <span class="token keyword">var</span> middlewares <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token function">require</span><span class="token punctuation">(</span>‘grunt<span class="token operator">-</span>connect<span class="token operator">-</span>proxy<span class="token operator">/</span>lib<span class="token operator">/</span>utils‘<span class="token punctuation">)</span><span class="token punctuation">.</span>proxyRequest<span class="token punctuation">]</span><span class="token punctuation">;</span>
            <span class="token comment">// Serve static files.</span>
            options<span class="token punctuation">.</span>base<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span>base<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                middlewares<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token function">serveStatic</span><span class="token punctuation">(</span>base<span class="token punctuation">.</span>path<span class="token punctuation">,</span> base<span class="token punctuation">.</span>options<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">// Make directory browse-able.</span>
            <span class="token comment">/*var directory = options.directory || options.base[options.base.length - 1];
             middlewares.push(connect.directory(directory));
             */</span>
            <span class="token keyword">return</span> middlewares<span class="token punctuation">;</span>
         <span class="token punctuation">}</span>
       <span class="token punctuation">}</span>
     <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>           
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br></div></div><p><strong>3.使用grunt脚手架解决跨域</strong></p> <p>webpack如今在前端的三大框架中使用的比较广泛，我们以vue为例子，vue-cli中config/index.js中是这样配置代理的：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>port<span class="token punctuation">:</span> <span class="token number">8090</span><span class="token punctuation">,</span>    
proxyTable<span class="token punctuation">:</span> <span class="token punctuation">{</span>
                <span class="token string">'/'</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
                 target<span class="token punctuation">:</span> targeturl<span class="token punctuation">,</span>
                 changeOrigin<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
                 pathRewrite<span class="token punctuation">:</span> <span class="token punctuation">{</span>
                      <span class="token string">'^/'</span><span class="token punctuation">:</span> <span class="token string">'/'</span>
                      <span class="token punctuation">}</span><span class="token punctuation">,</span>
                   <span class="token punctuation">}</span>
         <span class="token punctuation">}</span>js
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>我们可以看到，这三种方式都是需要本地先开启服务的，target配置请求服务器的地址， Rewrite配置代理规则， changeOrigin设为true意思是同意将主机头的来源更改为目标URL。</p> <p>这种代理解决跨域，前端正常写ajax就行。</p> <h4 id="jsonp"><a href="#jsonp" aria-hidden="true" class="header-anchor">#</a> Jsonp</h4> <p>Jsonp是通过web页面所有拥有src属性的标签都拥有跨域能力的属性，使客户端通过像调用脚本一样的方式，调用跨域服务器生成的js格式文件来获取数据。</p> <p>具体实现如下。</p> <p>服务端代码：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>    router<span class="token punctuation">.</span><span class="token keyword">get</span><span class="token punctuation">(</span><span class="token string">'/jsonp'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span>req<span class="token punctuation">,</span> res<span class="token punctuation">,</span> next<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> userName <span class="token operator">=</span> req<span class="token punctuation">.</span>query<span class="token punctuation">.</span>uname<span class="token punctuation">;</span>
    <span class="token keyword">var</span> password <span class="token operator">=</span> req<span class="token punctuation">.</span>query<span class="token punctuation">.</span>pwd<span class="token punctuation">;</span>
    <span class="token keyword">var</span> data <span class="token operator">=</span> <span class="token punctuation">{</span>
        code<span class="token punctuation">:</span> <span class="token number">200</span><span class="token punctuation">,</span>
        user<span class="token punctuation">:</span> userName<span class="token punctuation">,</span>
        password<span class="token punctuation">:</span> password
    <span class="token punctuation">}</span>
    res<span class="token punctuation">.</span><span class="token function">jsonp</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>前端端代码：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>    $<span class="token punctuation">.</span><span class="token function">ajax</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token keyword">async</span><span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    url<span class="token punctuation">:</span> <span class="token string">&quot;http://localhost:3000/jsonp&quot;</span><span class="token punctuation">,</span>
    type<span class="token punctuation">:</span> <span class="token string">&quot;GET&quot;</span><span class="token punctuation">,</span>
    dataType<span class="token punctuation">:</span> <span class="token string">&quot;jsonp&quot;</span><span class="token punctuation">,</span> <span class="token comment">// 返回的数据类型，设置为JSONP方式</span>
    jsonp<span class="token punctuation">:</span> <span class="token string">'callback'</span><span class="token punctuation">,</span> <span class="token comment">//指定一个查询参数名称来覆盖默认的 jsonp 回调参数名 callback</span>
    jsonpCallback<span class="token punctuation">:</span> <span class="token string">'xxx'</span><span class="token punctuation">,</span> <span class="token comment">//设置回调函数名</span>
    data<span class="token punctuation">:</span> <span class="token punctuation">{</span>
        <span class="token string">&quot;uname&quot;</span><span class="token punctuation">:</span> <span class="token string">'jsonp'</span><span class="token punctuation">,</span>
        <span class="token string">&quot;pwd&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;456&quot;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    success<span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span>response<span class="token punctuation">,</span> status<span class="token punctuation">,</span> xhr<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>response<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><h4 id="cors"><a href="#cors" aria-hidden="true" class="header-anchor">#</a> Cors</h4> <p>Cross-Origin Rseouce Sharing（cors）跨域资源共享是W3C定义的通过使用自定义的http请求头，实现跨域访问资源时，浏览器和服务器之间的正常通讯，相比jsonp，cors更加先进方便可靠。</p> <p>具体实现如下。</p> <p>服务端代码：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>    router<span class="token punctuation">.</span><span class="token keyword">get</span><span class="token punctuation">(</span><span class="token string">'/cors'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span>req<span class="token punctuation">,</span> res<span class="token punctuation">,</span> next<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> userName <span class="token operator">=</span> req<span class="token punctuation">.</span>query<span class="token punctuation">.</span>uname<span class="token punctuation">;</span>
    <span class="token keyword">var</span> password <span class="token operator">=</span> req<span class="token punctuation">.</span>query<span class="token punctuation">.</span>pwd<span class="token punctuation">;</span>
    <span class="token keyword">var</span> data <span class="token operator">=</span> <span class="token punctuation">{</span>
        code<span class="token punctuation">:</span> <span class="token number">200</span><span class="token punctuation">,</span>
        user<span class="token punctuation">:</span> userName<span class="token punctuation">,</span>
        password<span class="token punctuation">:</span> password
    <span class="token punctuation">}</span>
    res<span class="token punctuation">.</span><span class="token function">header</span><span class="token punctuation">(</span><span class="token string">&quot;Access-Control-Allow-Origin&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;*&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// *代表接受任何域名跨域,可使用指定ip替换*</span>
    res<span class="token punctuation">.</span><span class="token function">header</span><span class="token punctuation">(</span><span class="token string">'Access-Control-Allow-Methods'</span><span class="token punctuation">,</span> <span class="token string">'GET, POST'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//用来列出浏览器的cors请求还会用到那些http方法.</span>
    res<span class="token punctuation">.</span><span class="token function">header</span><span class="token punctuation">(</span><span class="token string">'Access-Control-Allow-Headers'</span><span class="token punctuation">,</span> <span class="token string">'X-Requested-With,content-type, Authorization'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//用来指定浏览器cors请求发送的头信息字段,可不写</span>
    res<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><p>前端端代码：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>    $<span class="token punctuation">.</span><span class="token function">ajax</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    url<span class="token punctuation">:</span> <span class="token string">&quot;http://localhost:3000/cors&quot;</span><span class="token punctuation">,</span>
    type<span class="token punctuation">:</span> <span class="token string">&quot;get&quot;</span><span class="token punctuation">,</span>
    data<span class="token punctuation">:</span> <span class="token punctuation">{</span>
        <span class="token string">&quot;uname&quot;</span><span class="token punctuation">:</span> <span class="token string">'cors'</span><span class="token punctuation">,</span>
        <span class="token string">&quot;pwd&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;123&quot;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    success<span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    error<span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'fail'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><h4 id="端口转发映射"><a href="#端口转发映射" aria-hidden="true" class="header-anchor">#</a> 端口转发映射</h4> <p>端口转发是转发一个网络端口从一个网络节点到另一个网络节点的行为，其使一个外部用户从外部经过一个被激活的NAT路由器到达一个在私有内部IP地址（局域网内部）上的一个端口。当我们把端口转发到与请求服务器相同的时候，就同源了，也不会出现跨域。</p> <p>具体实现：</p> <p>过程:</p> <p>（1）启动网卡的转发功能：1 &gt; /proc/sys/net/ipv4/ip_forward</p> <p>（2）增加转发规则</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>   iptables <span class="token operator">-</span>t nat <span class="token operator">-</span><span class="token constant">A</span> <span class="token constant">PREROUTING</span> <span class="token operator">-</span>p tcp <span class="token operator">-</span>i eth0 <span class="token operator">--</span>dport 本机端口 <span class="token operator">-</span>j <span class="token constant">DNAT</span> <span class="token operator">--</span>to 需转发的ip<span class="token punctuation">:</span>端口
   iptables <span class="token operator">-</span>t nat <span class="token operator">-</span><span class="token constant">A</span> <span class="token constant">POSTROUTING</span> <span class="token operator">-</span>j <span class="token constant">MASQUERADE</span>
   <span class="token keyword">for</span> example<span class="token punctuation">:</span> 我们当前ip为<span class="token number">123.0</span><span class="token number">.0</span><span class="token number">.1</span>我们想通过<span class="token number">1230.0</span><span class="token number">.0</span><span class="token number">.1</span>访问<span class="token number">2340.0</span><span class="token number">.0</span><span class="token number">.1</span><span class="token punctuation">:</span><span class="token number">90</span>的服务
   iptables <span class="token operator">-</span>t nat <span class="token operator">-</span><span class="token constant">A</span> <span class="token constant">PREROUTING</span> <span class="token operator">-</span>p tcp <span class="token operator">-</span>i eth0 <span class="token operator">--</span>dport <span class="token number">80</span> <span class="token operator">-</span>j <span class="token constant">DNAT</span> <span class="token operator">--</span>to <span class="token number">2340.0</span><span class="token number">.0</span><span class="token number">.1</span><span class="token punctuation">:</span><span class="token number">90</span>
   iptables <span class="token operator">-</span>t nat <span class="token operator">-</span><span class="token constant">A</span> <span class="token constant">POSTROUTING</span> <span class="token operator">-</span>j <span class="token constant">MASQUERADE</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>（3）查询本机转发规则</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>   iptables <span class="token operator">-</span>t nat <span class="token operator">-</span><span class="token constant">L</span> <span class="token operator">-</span>n  <span class="token operator">|</span> grep <span class="token number">80</span>
   这会出现所有<span class="token number">80</span>端口转发的规则
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>（4）删除规则</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>   iptables <span class="token operator">-</span>t nat <span class="token operator">-</span><span class="token constant">D</span> <span class="token constant">PREROUTING</span> <span class="token operator">-</span>p tcp <span class="token operator">-</span>i eth0 <span class="token operator">--</span>dport 本机端口 <span class="token operator">-</span>j <span class="token constant">DNAT</span> <span class="token operator">--</span>to 需转发的ip<span class="token punctuation">:</span>端口
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>另外，做本机端口转发，需要配置output链本机访问外网的端口会转发到本地，导致访不到外网，如访问woniuchiyum.top，实际上是访问到本地，建议不做80端口的转发或者指定目的 -d localhost)：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>   iptables <span class="token operator">-</span>t nat <span class="token operator">-</span><span class="token constant">A</span> <span class="token constant">OUTPUT</span> <span class="token operator">-</span>d localhost <span class="token operator">-</span>p tcp <span class="token operator">--</span>dport <span class="token number">80</span> <span class="token operator">-</span>j <span class="token constant">REDIRECT</span> <span class="token operator">--</span>to<span class="token operator">-</span>ports <span class="token number">8080</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><blockquote><p>PS：同一端口可以转发至多个ip，优先访问的是规则第一条，如果找不到会找下一个，全部找不到才会爆404。</p></blockquote> <p>如本机端口在转发时已被使用，那么域名解析时，优先指向本机ip，然后才是被转发ip，但是使用IP访问的时候，是转发ip的服务。</p> <h4 id="内网穿透"><a href="#内网穿透" aria-hidden="true" class="header-anchor">#</a> 内网穿透</h4> <p>内网穿透其实就是高性能的反向代理服务器是一样的。但是是想方式和gulp，Grunt等等不同，配置更为简单方便。</p> <p>具体实现：</p> <p>（1）在frp官网下载源码，<a href="http://getfrp.yzxx-soft.com/" target="_blank" rel="noopener noreferrer">中文网址详见这里<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>。</p> <p>（2）我们将 frps 及 frps.ini 放到具有公网 IP 的服务器上，修改frps.ini 文件：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token punctuation">[</span>common<span class="token punctuation">]</span>
bind_port <span class="token operator">=</span> <span class="token number">7000</span>   <span class="token comment">//绑定端口,自定义,需要与 frp.ini 中server_port保持一致</span>
vhost_http_port <span class="token operator">=</span> <span class="token number">8080</span>  <span class="token comment">//访问端口,自定义</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>（3）启动frps，Windows 直接点击 frps.exe 运行，mac 根目录下终端运行./frps -c ./frps.ini。</p> <p>（4）将frp 及 frpc.ini 放到本地，修改frpc.ini 文件：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token punctuation">[</span>common<span class="token punctuation">]</span>
server_addr <span class="token operator">=</span> xxxx <span class="token comment">//服务器公网ip</span>
server_port <span class="token operator">=</span>  <span class="token number">7000</span> <span class="token comment">//需要与 frps.ini 中server_port保持一致</span>
<span class="token punctuation">[</span>web<span class="token punctuation">]</span>
type <span class="token operator">=</span> http  
local_port <span class="token operator">=</span> <span class="token number">8080</span>   <span class="token comment">//本地服务端口</span>
local_addr <span class="token operator">=</span> <span class="token number">10.10</span><span class="token number">.50</span><span class="token number">.37</span>  <span class="token comment">//本机的ip windows cmd运行ipconfig mac 终端运行 ifconfig查看本机ip</span>
custom_domains <span class="token operator">=</span> 服务器域名
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>（5）本地启动frp，windows直接点击frp.exe运行，mac 根目录下终端运行./frpc -c ./frpc.ini。</p> <p>（6）浏览器输入 frp.ini中设置的服务器域名：frps.ini中设置的访问端口，即可访问。</p> <p>附：</p> <ul><li>本地启动frp之前，需要先启动本地的web服务。</li> <li>frp官网中frp.ini文件没有设置 local_addr，但是不设置这个运行frps.ini 会报错get hostname error，这个大家自己测试。</li></ul> <h4 id="修改浏览器配置"><a href="#修改浏览器配置" aria-hidden="true" class="header-anchor">#</a> 修改浏览器配置</h4> <p>除了上述的代码修改意外，有个超级简单，但是不怎么推荐大家使用的方法，就是修改浏览器配置，关闭安全策略。前面说了跨域访问是被各大浏览器所默认禁止的，但是如果我们在开发的时候不禁止也是可以的。</p> <p>chrome是前端开发中很好的调试浏览器，里面就有关闭安全策略，允许访问的设置。</p> <p>注意，设置关闭安全策略之前，请先关掉chrome。</p> <p>mac:</p> <p>打开终端输入命令行</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">//chrome 浏览器</span>
open <span class="token operator">-</span>a <span class="token string">&quot;Google Chrome&quot;</span> <span class="token operator">--</span>args <span class="token operator">--</span>disable<span class="token operator">-</span>web<span class="token operator">-</span>security  <span class="token operator">--</span>user<span class="token operator">-</span>data<span class="token operator">-</span>dir
<span class="token comment">//safari mac电脑safari也可以设置</span>
open <span class="token operator">-</span>a <span class="token string">'/Applications/Safari.app'</span> <span class="token operator">--</span>args <span class="token operator">--</span>disable<span class="token operator">-</span>web<span class="token operator">-</span>security <span class="token operator">--</span>user<span class="token operator">-</span>data<span class="token operator">-</span>dir 
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>windows下：</p> <p><strong>1.命令行打开</strong></p> <p>首先找到chrome.exe图标，查看当前路径，粘贴保存路径，然后在cmd输入</p> <p>chrome.exe路径 --disable-web-security --user-data-dir</p> <p><strong>2.配置快捷方式打开</strong></p> <p>新建桌面快捷方式，快捷方式后面空一格加上下面这句话 --disable-web-security --user-data-dir 然后就ok了。</p> <p>注意：除了jsonp ，端口映射，cors这三种方式外，别的跨域解决方式只是在我们开发环境中解决了跨域，发布环境如果存在某一种非同源条件还是有跨域问题的。所以，需要根据不同场景，选择适合我们的跨域解决方案。那么如何选择适合我们的跨域方式呢？</p> <ul><li>普通html页面开发，代码部署路径和后端服务在同一服务器下面。 荐使用gulp，理由：简单容易搭建，gulp还可扩展打包，压缩等等服务。第二推荐grunt，grunt和gulp本来就相同，但是相对写gulp的server和watch操作更简单。</li> <li>使用vue angular react框架，代码部署路径和后端服务在同一服务器下面。</li></ul> <p>建议使用webpack，框架中一般vue-cli angular-cli都带已经有webpack的配置了，我们只用配置代理路径就可以。</p> <ul><li>微信公众号的开发，代码部署路径和后端服务在同一服务器下面。</li></ul> <p>建议使用内网穿透，微信公众号的开发相对来说比较麻烦，因为我们除了要解决前后端分离的跨域问题，我们调试微信jdk的时候，必须在微信开发工具中调试，也就是说，每次更改代码都需要部署到服务器，然后才可以调试，使用内网穿透可以很好解决这个问题。因为内网穿透直接把我们本地代码映射到了服务器。</p> <ul><li>sso等等后端服务和前端服务不在同一台服务器上</li></ul> <p>建议使用cors，当多个在不同服务器的前端系统共用一个接口，或者别的前后端在不同服务器上时候，cors是一劳永逸的最便捷的方式。</p></div> <span id="footerPost" data-v-991417e8></span></div> <div id="post-toc" class="post-toc el-col el-col-6" data-v-991417e8><h4 class="catalog-title" data-v-991417e8>TOC</h4> <div class="catalog-body" data-v-991417e8><ul id="catalog-list" class="catalog-list" data-v-991417e8></ul></div></div></div> <div class="post-nav el-row is-justify-space-around el-row--flex" data-v-991417e8><div class="post-prev el-col el-col-7" data-v-991417e8><div data-v-991417e8><a href="/blog/posts/JavaScript/array.html" data-v-991417e8><i class="el-icon-arrow-left" data-v-991417e8></i> Prev
        </a> <p class="nav-title" data-v-991417e8>数组总结</p></div></div> <div class="post-next el-col el-col-7 el-col-lg-pull-5" data-v-991417e8><div data-v-991417e8><a href="/blog/posts/component/%E7%BB%84%E4%BB%B6%EF%BC%9A%E7%BB%84%E4%BB%B6%E9%97%B4%E9%80%9A%E8%AE%AF.html" data-v-991417e8>
          Next
          <i class="el-icon-arrow-right" data-v-991417e8></i></a> <p class="nav-title" data-v-991417e8>组件：通信 angular、vue组件间通信</p></div></div></div> <div class="el-row is-justify-center el-row--flex" data-v-991417e8></div> <span data-v-1ba756dd data-v-991417e8><button type="button" class="el-button toc-btn el-button--primary is-circle" data-v-1ba756dd><!----><!----><span><i class="iconfont icon-service-directory" data-v-1ba756dd></i></span></button> <button type="button" class="el-button gotop-btn el-button--primary is-circle" data-v-1ba756dd><!----><!----><span><i class="el-icon-arrow-up" data-v-1ba756dd></i></span></button></span></div></main></section> <button type="button" class="el-button gotop-btn el-button--primary is-circle" style="display:none;" data-v-db63bc4e data-v-5d0d200e><!----><!----><span><i class="el-icon-arrow-up" data-v-db63bc4e></i></span></button></section> <footer class="el-footer container-footer" style="height:60px;" data-v-6419f3ca data-v-5d0d200e><div class="footer-warp el-row is-justify-center is-align-center el-row--flex footerMargin" data-v-6419f3ca><div class="footer-top el-col el-col-24" data-v-6419f3ca><p class="ellipsis" data-v-6419f3ca><span data-v-6419f3ca>
          博客内容遵循
          <a rel="license" href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" data-v-6419f3ca>知识共享 署名 - 非商业性 - 相同方式共享 4.0 国际协议</a></span></p></div> <div class="footer-bottom el-col el-col-24" data-v-6419f3ca><p class="ellipsis" data-v-6419f3ca><span data-v-6419f3ca><span data-v-6419f3ca>
            jinjun © 2016/12 ~ 2019/3/
          </span></span> <span data-v-6419f3ca>
          Power by
          <a href="https://vuepress.vuejs.org/zh/" target="_blank" data-v-6419f3ca>VuePress</a></span></p></div></div></footer> <div class="overlay" data-v-5d0d200e></div></div><div class="global-ui"></div></div>
    <script src="/blog/assets/js/app.962901cb.js" defer></script><script src="/blog/assets/js/1.36b4da28.js" defer></script><script src="/blog/assets/js/16.1efe9ae9.js" defer></script><script src="/blog/assets/js/5.ab75d492.js" defer></script><script src="/blog/assets/js/7.5ca7d561.js" defer></script><script src="/blog/assets/js/14.fca58736.js" defer></script><script src="/blog/assets/js/6.da834821.js" defer></script><script src="/blog/assets/js/42.07cb1b93.js" defer></script><script src="/blog/assets/js/15.9cf39d09.js" defer></script><script src="/blog/assets/js/17.c81a99c6.js" defer></script>
  </body>
</html>
