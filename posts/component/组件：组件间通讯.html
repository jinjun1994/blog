<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no, minimal-ui"
    />
    <title>组件：通信 angular、vue组件间通信 | jinjun</title>
    <meta name="description" content="前端开发 JavaScript webpack 金俊 jinjun " />
    <meta property="og:type" content="website" />
    <meta property="og:title" content="组件：通信 angular、vue组件间通信 | jinjun" />
    <meta property="og:site_name" content="组件：通信 angular、vue组件间通信 | jinjun" />
    <meta property="og:locale" content="zh-CN" />
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:title" content="组件：通信 angular、vue组件间通信 | jinjun" />
    <link rel="shortcut icon" href="/blog/favicon.ico">
    
    <link rel="preload" href="/blog/assets/css/0.styles.bc81ad81.css" as="style"><link rel="preload" href="/blog/assets/js/app.1a6b459b.js" as="script"><link rel="preload" href="/blog/assets/js/1.c85d1694.js" as="script"><link rel="preload" href="/blog/assets/js/16.cd5d85ab.js" as="script"><link rel="preload" href="/blog/assets/js/5.ac05350e.js" as="script"><link rel="preload" href="/blog/assets/js/7.e7baed12.js" as="script"><link rel="preload" href="/blog/assets/js/14.6682b562.js" as="script"><link rel="preload" href="/blog/assets/js/6.df15a82e.js" as="script"><link rel="preload" href="/blog/assets/js/31.044d7af0.js" as="script"><link rel="preload" href="/blog/assets/js/15.3c31a18d.js" as="script"><link rel="preload" href="/blog/assets/js/17.c44e1b3d.js" as="script"><link rel="prefetch" href="/blog/assets/js/10.1b427022.js"><link rel="prefetch" href="/blog/assets/js/11.73645caf.js"><link rel="prefetch" href="/blog/assets/js/12.2172bbd7.js"><link rel="prefetch" href="/blog/assets/js/13.03f49701.js"><link rel="prefetch" href="/blog/assets/js/18.b2576757.js"><link rel="prefetch" href="/blog/assets/js/19.2d663f60.js"><link rel="prefetch" href="/blog/assets/js/20.9dcc6670.js"><link rel="prefetch" href="/blog/assets/js/21.04adcd03.js"><link rel="prefetch" href="/blog/assets/js/22.6235e2d6.js"><link rel="prefetch" href="/blog/assets/js/23.2b93aeba.js"><link rel="prefetch" href="/blog/assets/js/24.7d448ad2.js"><link rel="prefetch" href="/blog/assets/js/25.3b0efd31.js"><link rel="prefetch" href="/blog/assets/js/26.4036117d.js"><link rel="prefetch" href="/blog/assets/js/27.b0291263.js"><link rel="prefetch" href="/blog/assets/js/28.085922a6.js"><link rel="prefetch" href="/blog/assets/js/29.a30387ba.js"><link rel="prefetch" href="/blog/assets/js/30.206be43f.js"><link rel="prefetch" href="/blog/assets/js/32.aeec4d5a.js"><link rel="prefetch" href="/blog/assets/js/33.7ea2d270.js"><link rel="prefetch" href="/blog/assets/js/34.d825dde5.js"><link rel="prefetch" href="/blog/assets/js/35.4d052222.js"><link rel="prefetch" href="/blog/assets/js/36.353a7858.js"><link rel="prefetch" href="/blog/assets/js/37.5796cf5e.js"><link rel="prefetch" href="/blog/assets/js/38.16bdd7b6.js"><link rel="prefetch" href="/blog/assets/js/39.efe944bf.js"><link rel="prefetch" href="/blog/assets/js/4.c0856dc5.js"><link rel="prefetch" href="/blog/assets/js/40.f6b173d4.js"><link rel="prefetch" href="/blog/assets/js/41.9027f88a.js"><link rel="prefetch" href="/blog/assets/js/42.749296b3.js"><link rel="prefetch" href="/blog/assets/js/43.e932fd44.js"><link rel="prefetch" href="/blog/assets/js/44.c0d33ee4.js"><link rel="prefetch" href="/blog/assets/js/8.8dc4c424.js"><link rel="prefetch" href="/blog/assets/js/9.eb9876f1.js"><link rel="prefetch" href="/blog/assets/js/search.56704786.js">
    <link rel="stylesheet" href="/blog/assets/css/0.styles.bc81ad81.css">
  </head>
  <body>
    <div id="loader-wrapper" style="display: none;opacity:0">
      <div id="loader"></div>
      <div class="loader-section section-left"></div>
      <div class="loader-section section-right"></div>
    </div>
    <div id="app" data-server-rendered="true"><div style="height:100%;" data-v-5d0d200e><section class="el-container main-container" data-v-5d0d200e><aside class="el-aside menu" style="width:auto;" data-v-7a66351a data-v-5d0d200e><ul role="menubar" class="menu-wrap el-menu" style="background-color:;" data-v-7a66351a><li data-v-7a66351a><div class="brand-wrap" style="background-image:url();" data-v-7a66351a><div class="brand" data-v-7a66351a><a href="/blog/" class="avatar waves-effect waves-circle waves-light router-link-active" data-v-7a66351a><img src="/blog/avatar.png" data-v-7a66351a></a> <hgroup class="introduce" data-v-7a66351a><div class="nickname" data-v-7a66351a>jinjun</div> <a title="jinjun199403@gmail.com" class="mail" data-v-7a66351a>jinjun199403@gmail.com</a></hgroup></div></div></li> <li role="menuitem" tabindex="-1" class="el-menu-item" style="padding-left:20px;color:;background-color:;" data-v-7a66351a><i class="iconfont icon-home" data-v-7a66351a></i> <span class="item-title" data-v-7a66351a>主页</span></li> <li role="menuitem" tabindex="-1" class="el-menu-item" style="padding-left:20px;color:;background-color:;" data-v-7a66351a><i class="iconfont icon-biaoqian" data-v-7a66351a></i> <span class="item-title" data-v-7a66351a>标签分类</span></li> <li role="menuitem" tabindex="-1" class="el-menu-item" style="padding-left:20px;color:;background-color:;" data-v-7a66351a><i class="iconfont icon-wenzhang" data-v-7a66351a></i> <span class="item-title" data-v-7a66351a>时间归档</span></li> <li role="menuitem" tabindex="-1" class="el-menu-item" style="padding-left:20px;color:;background-color:;" data-v-7a66351a><i class="iconfont icon-github" data-v-7a66351a></i> <span class="item-title" data-v-7a66351a>Github</span></li> <li role="menuitem" tabindex="-1" class="el-menu-item" style="padding-left:20px;color:;background-color:;" data-v-7a66351a><i class="iconfont icon-aboutme" data-v-7a66351a></i> <span class="item-title" data-v-7a66351a>关于我</span></li></ul></aside> <section class="el-container container-warp" data-v-5d0d200e><header id="topHeader" class="el-header top-header" style="height:60px;padding-left:260px;" data-v-462e0cef data-v-5d0d200e><div class="header-warp el-row is-align-middle el-row--flex" data-v-462e0cef><div class="el-col el-col-12 el-col-xs-7" data-v-462e0cef><div class="el-row is-align-middle el-row--flex" data-v-462e0cef><div class="el-col el-col-2" data-v-462e0cef><button type="button" class="el-button el-button--primary is-circle" data-v-462e0cef><!----><!----><span><i class="iconfont icon-caidan" data-v-462e0cef></i></span></button></div></div></div> <div class="el-col el-col-20 el-col-xs-24" data-v-462e0cef><div class="grid-content bg-purple-light" data-v-462e0cef><div class="el-row is-justify-end is-align-middle el-row--flex" data-v-462e0cef><div class="el-col el-col-13 el-col-xs-24 el-col-sm-21 el-col-md-17 el-col-lg-13" data-v-462e0cef><div aria-haspopup="listbox" role="combobox" aria-owns="el-autocomplete-6293" class="el-autocomplete search-input" data-v-462e0cef><div class="el-input el-input--small el-input--suffix"><!----><input type="text" autocomplete="off" valueKey="value" popperClass="search-popper" placeholder="搜搜看" fetchSuggestions="function () { [native code] }" debounce="300" placement="bottom-start" popperAppendToBody="true" value="" class="el-input__inner"><!----><span class="el-input__suffix"><span class="el-input__suffix-inner"><i class="el-input__icon el-icon-search search-ico" data-v-462e0cef></i><!----><!----><!----></span><!----></span><!----></div><div role="region" class="el-autocomplete-suggestion el-popper search-popper" style="width:;display:none;"><div class="el-scrollbar"><div class="el-autocomplete-suggestion__wrap el-scrollbar__wrap el-scrollbar__wrap--hidden-default"><ul class="el-scrollbar__view el-autocomplete-suggestion__list"></ul></div><div class="el-scrollbar__bar is-horizontal"><div class="el-scrollbar__thumb" style="width:0;transform:translateX(0%);ms-transform:translateX(0%);webkit-transform:translateX(0%);"></div></div><div class="el-scrollbar__bar is-vertical"><div class="el-scrollbar__thumb" style="height:0;transform:translateY(0%);ms-transform:translateY(0%);webkit-transform:translateY(0%);"></div></div></div></div></div></div></div></div></div></div></header> <main class="el-main my-main" style="margin-left:240px;" data-v-c4863568 data-v-5d0d200e><div class="content-header index-header" data-v-82ac95c6 data-v-c4863568><div class="container fade-scale in" data-v-82ac95c6><h1 id="conentHeader" class="title" data-v-82ac95c6>组件：通信 angular、vue组件间通信</h1> <h5 class="subtitle" data-v-82ac95c6></h5></div></div> <div data-v-991417e8 data-v-c4863568 data-v-c4863568><div class="post-content el-row is-justify-center el-row--flex" data-v-991417e8><div id="post-card" class="post-card el-col el-col-16 el-col-xs-24 el-col-sm-23 el-col-md-23 el-col-lg-16" data-v-991417e8><div class="content default"><h2 id="组件：组件间通讯"><a href="#组件：组件间通讯" aria-hidden="true" class="header-anchor">#</a> 组件：组件间通讯</h2> <p><img src="http://images.gitbook.cn/08a931a0-ae67-11e7-8003-dd1d9d56caa7" alt="enter image description here"></p> <p>组件就像零散的积木，我们需要把这些积木按照一定的规则拼装起来，而且要让它们互相之间能进行通讯，这样才能构成一个有机的完整系统。</p> <p>在真实的应用中，组件最终会构成树形结构，就像人类社会中的家族树一样：</p> <p><img src="http://images.gitbook.cn/891636a0-af23-11e7-b111-4d6e630f480d" alt="enter image description here"></p> <p>在树形结构里面，组件之间有几种典型的关系：父子关系、兄弟关系、没有直接关系。</p> <p>相应地，组件之间有以下几种典型的通讯方案：</p> <ul><li>直接的父子关系：父组件直接访问子组件的 public 属性和方法。</li> <li>直接的父子关系：借助于 @Input 和 @Output 进行通讯</li> <li>没有直接关系：借助于 Service 单例进行通讯。</li> <li>利用 cookie 和 localstorage 进行通讯。</li> <li>利用 session 进行通讯。</li></ul> <p>无论你使用什么前端框架，组件之间的通讯都离开不以上几种方案，这些方案与具体框架无关。</p> <h2 id="angular组件间通讯"><a href="#angular组件间通讯" aria-hidden="true" class="header-anchor">#</a> Angular组件间通讯</h2> <h3 id="直接调用"><a href="#直接调用" aria-hidden="true" class="header-anchor">#</a> 直接调用</h3> <p>对于有直接父子关系的组件，父组件可以直接访问子组件里面 public 型的属性和方法，示例代码片段如下：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>&lt;child #child&gt;&lt;/child&gt;
&lt;button (click)=&quot;child.childFn()&quot; class=&quot;btn btn-success&quot;&gt;调用子组件方法&lt;/button&gt;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>显然，子组件里面必须暴露一个 public 型的 childFn 方法，就像这样：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>public childFn():void{
    console.log(&quot;子组件的名字是&gt;&quot;+this.panelTitle);
}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>以上是通过在模板里面定义局部变量的方式来直接调用子组件里面的 public 型方法。在父组件的内部也可以访问到子组件的实例，需要利用到 @ViewChild 装饰器，示例如下：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>@ViewChild(ChildComponent)
private childComponent: ChildComponent;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>关于 @ViewChild 在后面的内容里面会有更详细的解释。</p> <p>很明显，如果父组件直接访问子组件，那么两个组件之间的关系就被固定死了。父子两个组件紧密依赖，谁也离不开谁，也就都不能单独使用了。所以，除非你知道自己在做什么，最好不要直接在父组件里面直接访问子组件上的属性和方法，以免未来一改一大片。</p> <h3 id="input-和-output"><a href="#input-和-output" aria-hidden="true" class="header-anchor">#</a> @Input 和 @Output</h3> <p>我们可以利用 @Input 装饰器，让父组件直接给子组件传递参数，子组件上这样写：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>@Input()
public panelTitle:string;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>父组件上可以这样设置 panelTitle 这个参数：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>&lt;child panelTitle=&quot;一个新的标题&quot;&gt;&lt;/child&gt;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>@Output 的本质是事件机制，我们可以利用它来监听子组件上派发的事件，子组件上这样写：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>@Output()
public follow=new EventEmitter&lt;string&gt;();
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>触发 follow 事件的方式如下：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>this.follow.emit(&quot;follow&quot;);
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>父组件上可以这样监听 follow 事件：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>&lt;child (follow)=&quot;doSomething()&quot;&gt;&lt;/child&gt;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>我们可以利用 @Output 来自定义事件，监听自定义事件的方式也是通过小圆括号，与监听 HTML 原生事件的方式一模一样。</p> <h3 id="利用-service-单例进行通讯"><a href="#利用-service-单例进行通讯" aria-hidden="true" class="header-anchor">#</a> 利用 Service 单例进行通讯</h3> <p><img src="http://images.gitbook.cn/d2615600-af23-11e7-9203-4582e2e80f6b" alt="enter image description here"></p> <p>如果你在根模块（一般是 app.module.ts）的 providers 里面注册一个 Service，那么这个 Service 就是全局单例的，这样一来我们就可以利用这个单例的 Service 在不同的组件之间进行通讯了。</p> <ul><li>比较粗暴的方式：我们可以在 Service 里面定义 public 型的共享变量，然后让不同的组件都来访问这块变量，从而达到共享数据的目的。</li> <li>优雅一点的方式：利用 RxJS，在 Service 里面定义一个 public 型的 Subject（主题），然后让所有组件都来subscribe（订阅）这个主题，类似于一种“事件总线”的效果。</li></ul> <p>实例代码片段：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>import { Injectable } from '@angular/core';
import { Observable } from 'rxjs/Observable';
import { Subject } from 'rxjs/Subject';

/**
 * 用来充当事件总线的Service
 */
@Injectable()
export class EventBusService {
  public eventBus:Subject&lt;string&gt; = new Subject&lt;string&gt;();

  constructor() { }

}
import { Component, OnInit } from '@angular/core';
import { EventBusService } from '../service/event-bus.service';

@Component({
  selector: 'child-1',
  templateUrl: './child-1.component.html',
  styleUrls: ['./child-1.component.css']
})
export class Child1Component implements OnInit {

  constructor(public eventBusService:EventBusService) { }

  ngOnInit() {
  }

  public triggerEventBus():void{
    this.eventBusService.eventBus.next(&quot;第一个组件触发的事件&quot;);
  }
}
import { Component, OnInit } from '@angular/core';
import { EventBusService } from '../service/event-bus.service';

@Component({
  selector: 'child-2',
  templateUrl: './child-2.component.html',
  styleUrls: ['./child-2.component.css']
})
export class Child2Component implements OnInit {
  public events:Array&lt;any&gt;=[];

  constructor(public eventBusService:EventBusService) {

  }

  ngOnInit() {
    this.eventBusService.eventBus.subscribe((value)=&gt;{
      this.events.push(value+&quot;-&quot;+new Date());
    });
  }
}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br></div></div><h3 id="利用-cookie-或者-localstorage-进行通讯"><a href="#利用-cookie-或者-localstorage-进行通讯" aria-hidden="true" class="header-anchor">#</a> 利用 cookie 或者 localstorage 进行通讯</h3> <p><img src="http://images.gitbook.cn/e9aaf1e0-af23-11e7-b111-4d6e630f480d" alt="enter image description here"></p> <p>示例代码片段：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>public writeData():void{
    window.localStorage.setItem(&quot;json&quot;,JSON.stringify({name:'jinjun',age:18}));
}
var json=window.localStorage.getItem(&quot;json&quot;);
// window.localStorage.removeItem(&quot;json&quot;);
var obj=JSON.parse(json);
console.log(obj.name);
console.log(obj.age);
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p><strong>很多朋友写 Angular 代码的时候出现了思维定势，总感觉 Angular 会封装所有东西，实际上并非如此。比如 cookie、localstorage 这些东西都可以直接用原生的 API 进行操作的。千万别忘记原生的那些 API 啊，都能用的！</strong></p> <h3 id="利用-session-进行通讯"><a href="#利用-session-进行通讯" aria-hidden="true" class="header-anchor">#</a> 利用 session 进行通讯</h3> <p><img src="http://images.gitbook.cn/79246040-af24-11e7-b111-4d6e630f480d" alt="enter image description here"></p> <h2 id="vue组件间通讯"><a href="#vue组件间通讯" aria-hidden="true" class="header-anchor">#</a> Vue组件间通讯</h2> <h3 id="现代通信方式-flux-vuex"><a href="#现代通信方式-flux-vuex" aria-hidden="true" class="header-anchor">#</a> 现代通信方式: FLUX VUEX</h3> <p><strong>FLUX将一个应用分成四个部分</strong>:<a href="https://link.juejin.im/?target=http%3A%2F%2Fwww.ruanyifeng.com%2Fblog%2F2016%2F01%2Fflux.html" target="_blank" rel="noopener noreferrer">文档<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <ol><li>View： 视图层</li> <li>Action（动作）：视图层发出的消息（比如mouseClick）</li> <li>Dispatcher（派发器）：用来接收Actions、执行回调函数</li> <li>Store（数据层Model）：用来存放应用的状态，一旦发生变动，就提醒Views要更新页面</li></ol> <p>flux最大的特性是“单向数据流”，具体流程：</p> <ol><li>用户访问 View,</li> <li>View 发出用户的 Action,</li> <li>Dispatcher 收到 Action，要求 Store 进行相应的更新</li> <li>Store 更新后，发出一个”change”事件</li> <li>View 收到”change”事件后，更新页面
<a href="https://link.juejin.im/?target=http%3A%2F%2Fzhentaoo.com%2Fimg%2Fflux.png" target="_blank" rel="noopener noreferrer"><img src="https://user-gold-cdn.xitu.io/2017/10/23/37363e31f10108cfbebdd300193fe6dc?imageView2/0/w/1280/h/960/format/webp/ignore-error/1" alt="img"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ol> <p><strong>VUEX</strong>:<a href="https://link.juejin.im/?target=https%3A%2F%2Fvuex.vuejs.org%2Fzh-cn%2Fintro.html" target="_blank" rel="noopener noreferrer">官方文档<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>
Vuex 是一个专为 Vue.js 应用程序开发的状态管理模式。它采用集中式存储管理应用的所有组件的状态，并以相应的规则保证状态以一种可预测的方式发生变化。
我们把组件的共享状态抽取出来，以一个全局单例模式管理,在这种模式下，我们的组件树构成了一个巨大的“视图”，不管在树的哪个位置，任何组件都能获取状态或者触发行为！
注：action可以是异步的，但mutations一定是同步的</p> <p>对于一个的VUEX应用来说,FLUX的概念被具化成：</p> <ol><li>VUE: 视图层</li> <li>Action（动作）：视图层发出的消息（比如mouseClick）</li> <li>Mutations（派发器）：用来接收Actions、执行回调函数</li> <li>State（数据层Model）：用来存放应用的状态，一旦发生变动，就提醒Vue要更新页面
<a href="https://link.juejin.im/?target=http%3A%2F%2Fzhentaoo.com%2Fimg%2Fvuex.png" target="_blank" rel="noopener noreferrer"><img src="https://user-gold-cdn.xitu.io/2017/10/23/45f2d7c2f94cfdc3fe3c72041319ce85?imageView2/0/w/1280/h/960/format/webp/ignore-error/1" alt="vuex"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>vuex</li></ol> <h3 id="父子组件通信-props，events"><a href="#父子组件通信-props，events" aria-hidden="true" class="header-anchor">#</a> 父子组件通信:props，events</h3> <p><strong>父-&gt;子</strong>: 父组件使用 props 把数据传给子组件,文档如下
<a href="https://link.juejin.im/?target=https%3A%2F%2Fcn.vuejs.org%2Fv2%2Fguide%2Fcomponents.html%23%E4%BD%BF%E7%94%A8-Prop-%E4%BC%A0%E9%80%92%E6%95%B0%E6%8D%AE" target="_blank" rel="noopener noreferrer">cn.vuejs.org/v2/guide/co…<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <div class="language- line-numbers-mode"><pre class="language-text"><code>&lt;child message=&quot;hello!&quot;&gt;&lt;/child&gt;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="language- line-numbers-mode"><pre class="language-text"><code>Vue.component('child', {
  // 声明 props
  props: ['message'],
  // 就像 data 一样，prop 可以用在模板内
  // 同样也可以在 vm 实例中像 “this.message” 这样使用
  template: '&lt;span&gt;{{ message }}&lt;/span&gt;'
})
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>需要<strong>注意</strong>的是，子组件不能修改父组件的props
因为一个父组件下可能有多个子组件，如果某个子组件修改了父组件传递的props，
很可能导致其他子组件也就跟着变化，最终导致整个应用的状态难以管理和维护
所以不允许子组件修改props</p> <p><strong>子-&gt;父</strong>: 子组件自定义事件，父组件可以在使用子组件的地方直接用 v-on 来监听子组件触发的事件</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>&lt;div id=&quot;counter-event-example&quot;&gt;
  &lt;p&gt;{{ total }}&lt;/p&gt;
  &lt;button-counter v-on:increment=&quot;incrementTotal&quot;&gt;&lt;/button-counter&gt;
  &lt;button-counter v-on:increment=&quot;incrementTotal&quot;&gt;&lt;/button-counter&gt;
&lt;/div&gt;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><div class="language- line-numbers-mode"><pre class="language-text"><code>Vue.component('button-counter', {
  template: '&lt;button v-on:click=&quot;increment&quot;&gt;{{ counter }}&lt;/button&gt;',
  data: function () {
    return {
      counter: 0
    }
  },
  methods: {
    increment: function () {
      this.counter += 1
      this.$emit('increment')
    }
  },
})
new Vue({
  el: '#counter-event-example',
  data: {
    total: 0
  },
  methods: {
    incrementTotal: function () {
      this.total += 1
    }
  }
})
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br></div></div><h3 id="非父子组件通信-event-bus"><a href="#非父子组件通信-event-bus" aria-hidden="true" class="header-anchor">#</a> 非父子组件通信: event bus</h3> <p>官方文档：<a href="https://link.juejin.im/?target=https%3A%2F%2Fcn.vuejs.org%2Fv2%2Fguide%2Fcomponents.html%23%E9%9D%9E%E7%88%B6%E5%AD%90%E7%BB%84%E4%BB%B6%E9%80%9A%E4%BF%A1" target="_blank" rel="noopener noreferrer">cn.vuejs.org/v2/guide/co…<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>
有时候非父子关系的组件也需要通信。在简单的场景下，使用一个空的 Vue 实例作为中央事件总线
在这两个组件之间引入这个中央事件总线，然后emit，on相应的事件</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>var bus = new Vue()
// 触发组件 A 中的事件
bus.$emit('id-selected', 1)
// 在组件 B 创建的钩子中监听事件
bus.$on('id-selected', function (id) {
  // ...
})
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h3 id="小结"><a href="#小结" aria-hidden="true" class="header-anchor">#</a> 小结</h3> <p>组件间的通讯方案是通用的，无论你使用什么样的前端框架，都会面临这个问题，而解决的方案无外乎本文所列出的几种。</p></div> <span id="footerPost" data-v-991417e8></span></div> <div id="post-toc" class="post-toc el-col el-col-6" data-v-991417e8><h4 class="catalog-title" data-v-991417e8>TOC</h4> <div class="catalog-body" data-v-991417e8><ul id="catalog-list" class="catalog-list" data-v-991417e8></ul></div></div></div> <div class="post-nav el-row is-justify-space-around el-row--flex" data-v-991417e8><div class="post-prev el-col el-col-7" data-v-991417e8><div data-v-991417e8><a href="/blog/posts/%E8%B7%A8%E5%9F%9F.html" data-v-991417e8><i class="el-icon-arrow-left" data-v-991417e8></i> Prev
        </a> <p class="nav-title" data-v-991417e8>前端跨域问题各种解决方案（开发环境中）</p></div></div> <div class="post-next el-col el-col-7 el-col-lg-pull-5" data-v-991417e8><div data-v-991417e8><a href="/blog/posts/component/%E7%BB%84%E4%BB%B6%EF%BC%9A%E5%86%85%E5%AE%B9%E6%8A%95%E5%BD%B1%EF%BC%88Angular%EF%BC%89%E3%80%81%E6%8F%92%E6%A7%BD%EF%BC%88Vue%EF%BC%89.html" data-v-991417e8>
          Next
          <i class="el-icon-arrow-right" data-v-991417e8></i></a> <p class="nav-title" data-v-991417e8>组件：插槽 Angular内容投影与Vue插槽</p></div></div></div> <div class="el-row is-justify-center el-row--flex" data-v-991417e8></div> <span data-v-1ba756dd data-v-991417e8><button type="button" class="el-button toc-btn el-button--primary is-circle" data-v-1ba756dd><!----><!----><span><i class="iconfont icon-service-directory" data-v-1ba756dd></i></span></button> <button type="button" class="el-button gotop-btn el-button--primary is-circle" data-v-1ba756dd><!----><!----><span><i class="el-icon-arrow-up" data-v-1ba756dd></i></span></button></span></div></main></section> <button type="button" class="el-button gotop-btn el-button--primary is-circle" style="display:none;" data-v-db63bc4e data-v-5d0d200e><!----><!----><span><i class="el-icon-arrow-up" data-v-db63bc4e></i></span></button></section> <footer class="el-footer container-footer" style="height:60px;" data-v-6419f3ca data-v-5d0d200e><div class="footer-warp el-row is-justify-center is-align-center el-row--flex footerMargin" data-v-6419f3ca><div class="footer-top el-col el-col-24" data-v-6419f3ca><p class="ellipsis" data-v-6419f3ca><span data-v-6419f3ca>
          博客内容遵循
          <a rel="license" href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" data-v-6419f3ca>知识共享 署名 - 非商业性 - 相同方式共享 4.0 国际协议</a></span></p></div> <div class="footer-bottom el-col el-col-24" data-v-6419f3ca><p class="ellipsis" data-v-6419f3ca><span data-v-6419f3ca><span data-v-6419f3ca>
            jinjun © 2016/12 ~ 2019/3/
          </span></span> <span data-v-6419f3ca>
          Power by
          <a href="https://vuepress.vuejs.org/zh/" target="_blank" data-v-6419f3ca>VuePress</a></span></p></div></div></footer> <div class="overlay" data-v-5d0d200e></div></div><div class="global-ui"></div></div>
    <script src="/blog/assets/js/app.1a6b459b.js" defer></script><script src="/blog/assets/js/1.c85d1694.js" defer></script><script src="/blog/assets/js/16.cd5d85ab.js" defer></script><script src="/blog/assets/js/5.ac05350e.js" defer></script><script src="/blog/assets/js/7.e7baed12.js" defer></script><script src="/blog/assets/js/14.6682b562.js" defer></script><script src="/blog/assets/js/6.df15a82e.js" defer></script><script src="/blog/assets/js/31.044d7af0.js" defer></script><script src="/blog/assets/js/15.3c31a18d.js" defer></script><script src="/blog/assets/js/17.c44e1b3d.js" defer></script>
  </body>
</html>
